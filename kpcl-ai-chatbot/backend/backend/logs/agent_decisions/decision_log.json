{"timestamp": "2026-02-22 13:41:22.209469", "user_id": "local_user", "prompt": "Which 'Dealer Name' has the highest total 'RunHrs.'", "generated_code": "final_answer = f\"The dealer with the highest total run hours is {df.groupby('Dealer Name')['RunHrs.'].sum().idxmax()}\""}
{"timestamp": "2026-02-22 15:36:29.070888", "user_id": "local_user", "prompt": "Which Dealer Name has the highest total RunHrs?", "generated_code": "final_answer = df.groupby('Dealer Name')['RunHrs.'].sum().idxmax()"}
{"timestamp": "2026-02-22 15:42:52.608224", "user_id": "local_user", "prompt": "What are the top 5 most frequent entries in 'Nature of complaint'?", "generated_code": "final_answer = f\"The top 5 most frequent entries in 'Nature of complaint' are:\\n{df['Nature of complaint'].value_counts().head(5).to_string()}\""}
{"timestamp": "2026-02-22 15:43:56.291786", "user_id": "local_user", "prompt": "\"How many total complaints are currently marked as 'Open' in the 'Open / Close' column?", "generated_code": "final_answer = f\"The total number of open complaints is {df[df['Open / Close'] == 'Open'].shape[0]}\""}
{"timestamp": "2026-02-22 15:44:27.888661", "user_id": "local_user", "prompt": "Which 'Customer Name' appears the most times in this dataset?", "generated_code": "import pandas as pd\n\n# Assuming df is already loaded with data\n\ncustomer_counts = df['Customer Name'].value_counts()\nmost_common_customer = customer_counts.idxmax()\n\nfinal_answer = f\"The 'Customer Name' that appears the most times is {most_common_customer} with {customer_counts.max()} occurrences.\""}
{"timestamp": "2026-02-22 15:45:32.214107", "user_id": "local_user", "prompt": "How many rows have an 'Exp/Domastic' status of 'Exp'", "generated_code": "final_answer = f\"The number of rows with an 'Exp/Domastic' status of 'Exp' is {df[df['Exp/Domastic'] == 'Exp'].shape[0]}\""}
{"timestamp": "2026-02-22 15:48:44.087832", "user_id": "local_user", "prompt": "What is the average 'RPM' across all compressors?\"", "generated_code": "final_answer = f\"The average RPM across all compressors is {df['RPM'].mean():.2f}\""}
{"timestamp": "2026-02-22 15:49:19.652118", "user_id": "local_user", "prompt": "Which 'Model' has the highest average 'RunHrs.'?", "generated_code": "import pandas as pd\n\n# Calculate the average run hours for each model\naverage_run_hours = df.groupby('Model')['RunHrs.'].mean().reset_index()\n\n# Find the model with the highest average run hours\nhighest_avg_model = average_run_hours.loc[average_run_hours['RunHrs.'].idxmax(), 'Model']\n\nfinal_answer = f\"The model with the highest average run hours is {highest_avg_model}\""}
{"timestamp": "2026-02-22 15:49:45.001445", "user_id": "local_user", "prompt": "What is the maximum 'Period -DD to DC in months.' recorded for any single compressor?", "generated_code": "final_answer = f\"The maximum 'Period -DD to DC in months.' recorded is {df['Period -DD to DC in months.'].max()}\""}
{"timestamp": "2026-02-22 15:51:47.089337", "user_id": "local_user", "prompt": "What is the most recent 'Date' recorded in this dataset?\"", "generated_code": "final_answer = f\"The most recent date recorded in the dataset is {df['Date'].max()}\""}
{"timestamp": "2026-02-22 15:52:11.728403", "user_id": "local_user", "prompt": "\"How many FSRs were logged in the year 2015 based on the 'Date' column?\"", "generated_code": "from datetime import datetime\n\ndf['Year'] = df['Date'].apply(lambda x: x.year if isinstance(x, datetime) else None)\nfsr_count_2015 = df[(df['Year'] == 2015) & (df['FSR No.'].notna())].shape[0]\nfinal_answer = f\"Number of FSRs logged in the year 2015: {fsr_count_2015}\""}
{"timestamp": "2026-02-22 15:52:54.234368", "user_id": "local_user", "prompt": "Which month had the highest number of complaints?\"", "generated_code": "import pandas as pd\n\n# Assuming df is already loaded with the necessary data\ncomplaints_per_month = df['Date'].dt.to_period('M').value_counts().sort_values(ascending=False)\nmost_complaints_month = complaints_per_month.idxmax()\nfinal_answer = f\"The month with the highest number of complaints was {most_complaints_month}.\""}
{"timestamp": "2026-02-22 15:55:12.259577", "user_id": "local_user", "prompt": "How many FSRs were logged in the year 2015 based on the 'Date' column?", "generated_code": "import pandas as pd\n\n# Assuming df is already loaded with the data\n\ntry:\n    filtered_df = df[df['Date'].dt.year == 2015]\n    final_answer = f\"The number of FSRs logged in the year 2015 is {filtered_df['FSR No.'].count()}\"\nexcept KeyError:\n    final_answer = \"I don't know, or I cannot find this data in the KPCL reports.\""}
{"timestamp": "2026-02-22 15:56:53.084637", "user_id": "local_user", "prompt": "Plot a bar chart showing the top 5 'Model' types by total count.", "generated_code": "import matplotlib.pyplot as plt\n\n# Calculate the top 5 models by count\ntop_5_models = df['Model'].value_counts().head(5)\n\n# Create a bar chart\nplt.figure(figsize=(10, 6))\ntop_5_models.plot(kind='bar')\nplt.title('Top 5 Models by Count')\nplt.xlabel('Model Type')\nplt.ylabel('Count')\n\n# Save the graph as 'temp_graph.png'\nplt.savefig('backend/data/temp_graph.png')\n\ngraph_generated = True\n\nfinal_answer = \"I don't know, or I cannot find this data in the KPCL reports.\""}
{"timestamp": "2026-02-22 15:57:42.043777", "user_id": "local_user", "prompt": "Plot a bar chart showing the top 5 'Model' types by total count.", "generated_code": "import pandas as pd\n\n# Group by 'Model' and calculate the sum of 'RunHrs.'\nmodel_counts = df['Model'].value_counts().head(5)\n\n# Create a bar chart\nplt.figure(figsize=(10, 6))\nmodel_counts.plot(kind='bar', color='skyblue')\n\n# Set labels and title\nplt.xlabel('Model')\nplt.ylabel('Count')\nplt.title('Top 5 Model Types by Count')\n\n# Save the graph as 'temp_graph.png'\nplt.savefig('backend/data/temp_graph.png')\ngraph_generated = True\n\n# Assign the final answer as an empty string since no numerical result is required\nfinal_answer = \"\""}
{"timestamp": "2026-02-22 15:58:24.044504", "user_id": "local_user", "prompt": "\"What is the total revenue generated by the top dealer?\"", "generated_code": "final_answer = \"I don't know, or I cannot find this data in the KPCL reports.\""}
{"timestamp": "2026-02-22 15:58:50.768735", "user_id": "local_user", "prompt": "Who is the CEO of the company?\"", "generated_code": "final_answer = \"I don't know, or I cannot find this data in the KPCL reports.\""}
{"timestamp": "2026-02-22 16:00:54.926424", "user_id": "local_user", "prompt": "Plot a bar chart showing the top 5 'Model' types by total count.", "generated_code": "import matplotlib.pyplot as plt\n\n# Calculate the count of each model\nmodel_counts = df['Model'].value_counts().head(5)\n\n# Create a bar chart\nplt.figure(figsize=(10, 6))\nmodel_counts.plot(kind='bar')\nplt.xlabel('Model')\nplt.ylabel('Count')\nplt.title('Top 5 Model Types by Total Count')\nplt.xticks(rotation=45)\nplt.tight_layout()\n\n# Save the graph as 'backend/data/temp_graph.png'\ngraph_generated = True\nplt.savefig('backend/data/temp_graph.png')\n\n# Assign the final answer\nfinal_answer = \"Graph generated successfully.\""}
